webpackJsonp([1],{"4Fqj":function(e,t){},"9Qoq":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},s,!1,function(e){n("4Fqj")},null,null).exports,r=n("/ocq"),l={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",path:"http://"+window.location.host+"/",form:{name:null}}},methods:{getToRoom:function(){if(null==this.form.name||""==this.form.name||0==this.form.name.length)return alert("请输入用户名!"),!1;var e=this;this.$axios.post(this.path+"/verfUSerName?username="+this.form.name).then(function(t){if(console.log(t.data),1!=t.data&&"true"!=t.data)return alert("用户已存在！"),!1;e.$router.push({path:"/zhangzq",query:{name:e.form.name}})}).catch(function(e){console.log(e)})}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("el-row",[n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.getToRoom}},[e._v("进入聊天室")])],1)],1)},staticRenderFns:[]};var u=n("VU/8")(l,i,!1,function(e){n("9Qoq")},"data-v-91fa18ba",null).exports,m=n("mvHQ"),c=n.n(m),f=(n("27ZK"),n("J0lJ"),{name:"Zhangzq",data:function(){return{msg:"chat room",path:"ws://"+window.location.host+"/websocket/",websocket:null,message:"",username:this.$route.query.name,value:"All",tableData:[],options:[]}},mounted:function(){if("WebSocket"in window){this.initWebSocket();var e=this;this.websocket.onmessage=function(t){var n=t.data;console.log("数据已接收:"+n);var a=JSON.parse(n);if(1==a.messageType)e.tableData.unshift({t:e.getTime(),fromusername:"系统消息",textMessage:a.username+"上线了"});else if(2==a.messageType){e.tableData.unshift({t:e.formartterTime(a.t),fromusername:"系统消息",textMessage:a.username+"下线了"}),this.options=[];var s=[];s.push({value:"All",label:"--所有--"});for(var o=0;o<a.onlineUsers.length;o++)a.onlineUsers[o]!=e.username&&s.push({value:a.onlineUsers[o],label:a.onlineUsers[o]});console.log(s),e.options=s}else if(3==a.messageType){this.options=[];var r=[];r.push({value:"All",label:"--所有--"});for(o=0;o<a.onlineUsers.length;o++)a.onlineUsers[o]!=e.username&&r.push({value:a.onlineUsers[o],label:a.onlineUsers[o]});console.log(r),e.options=r}else 4==a.messageType&&a.fromusername!=e.username&&e.tableData.unshift({t:a.t,fromusername:a.fromusername==e.username?"你":a.fromusername,textMessage:a.textMessage,tousername:a.tousername})}}else alert("不支持 web socket")},methods:{initWebSocket:function(){this.connection()},formatter:function(e,t){var n=e.t;return this.formartterTime(n)},formartterTime:function(e){return void 0!=e&&""!=e?e.substring(0,4)+"/"+e.substring(4,6)+"/"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14):""},getTime:function(){var e=new Date;return e.getFullYear()+this.formartNum(e.getMonth()+1)+this.formartNum(e.getDay())+this.formartNum(e.getHours())+this.formartNum(e.getMinutes())+this.formartNum(e.getSeconds())},formartNum:function(e){return e>10?e:"0"+e},sendMsg:function(){this.websocket.send(c()({message:this.message,username:this.username,to:this.value,tousername:this.value})),this.tableData.unshift({t:this.getTime(),fromusername:"你",textMessage:this.message,tousername:this.value})},reloadSelect:function(e){},connection:function(){this.websocket=new WebSocket(this.path+this.username),this.websocket.onopen=function(){console.log("已经连通了websocket")}}}}),h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v(e._s(e.msg))]),e._v(" "),n("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入内容"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.sendMsg}},[e._v("发送")]),e._v(" "),n("hr"),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{formatter:e.formatter,label:"时间",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"fromusername",label:"发送方",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"textMessage",label:"内容"}}),e._v(" "),n("el-table-column",{attrs:{prop:"tousername",label:"接收方",width:"180"}})],1)],1)},staticRenderFns:[]};var p=n("VU/8")(f,h,!1,function(e){n("PiYb")},"data-v-56ee1b88",null).exports,v=n("TcQY"),g=n.n(v),d=(n("P4yZ"),n("I29D")),b=n.n(d);a.default.prototype.$axios=b.a,a.default.use(g.a),a.default.use(r.a);var w=new r.a({routes:[{path:"/",name:"HelloWorld",component:u},{path:"/zhangzq",name:"Zhangzq",component:p}]});a.default.config.productionTip=!1,new a.default({el:"#app",router:w,components:{App:o},template:"<App/>"})},P4yZ:function(e,t){},PiYb:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.cffb22018b0837f93e66.js.map